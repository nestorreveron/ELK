# ğŸ› ï¸ Laboratorio: Despliegue de una AplicaciÃ³n Demo Generadora de Logs usando FluentBit y Kibana

## ğŸ“‹ Objetivo

Desplegar una aplicaciÃ³n de demostraciÃ³n que genere logs automÃ¡ticamente, recolectarlos con FluentBit, 
enviarlos a Elasticsearch y visualizar los logs en tiempo real usando Kibana.

---

## ğŸ“ Requisitos previos

* Haber completado laboratorios anteriores (DÃ­a 1 y DÃ­a 2).
* Azure VM configurada con Elasticsearch y Kibana.
* Acceso SSH a Azure VM y acceso al Azure Portal.

---

## âš™ï¸ Paso 1: ConexiÃ³n a tu Azure VM

ConÃ©ctate vÃ­a SSH a tu mÃ¡quina virtual:

```bash
ssh usuario@<ip-publica-vm>
```

---

## âš™ï¸ Paso 2: InstalaciÃ³n FluentBit

Ejecuta los siguientes comandos en tu VM:

```bash
curl https://raw.githubusercontent.com/fluent/fluent-bit/master/install.sh | sh
```

Verifica la instalaciÃ³n:

```bash
fluent-bit --version
```

---

## âš™ï¸ Paso 3: Crear AplicaciÃ³n Demo para Generar Logs

Crea y configura el archivo log:

```bash
sudo touch /var/log/demo.log
sudo chmod 666 /var/log/demo.log
```

Genera logs automÃ¡ticamente cada 5 segundos:

```bash
nohup bash -c 'while true; do echo "$(date) - Log demo generando valor $(shuf -i 1-100 -n 1)" >> /var/log/demo.log; sleep 5; done &' &
```

Verifica generaciÃ³n de logs:

```bash
tail -f /var/log/demo.log
```

---

## âš™ï¸ Paso 4: ConfiguraciÃ³n FluentBit

Edita el archivo de configuraciÃ³n:

```bash
sudo nano /etc/fluent-bit/fluent-bit.conf
```

Agrega la siguiente configuraciÃ³n bÃ¡sica:

```ini
[INPUT]
  name tail
  path /var/log/demo.log
  tag demo_logs

[OUTPUT]
  name es
  match demo_logs
  host localhost
  port 9200
  index fluentbit-demo
  generate_ID on
  logstash_format off
  suppress_type_name on

```

Guarda (`Ctrl+X`, `Y`, `Enter`).

---

## âš™ï¸ Paso 5: Iniciar FluentBit y modificar archivo .service

sudo vi /usr/lib/systemd/system/fluent-bit.service
>> ExecStart=/opt/fluent-bit/bin/fluent-bit -c /etc/fluent-bit/fluent-bit.conf
Salir y guardar


Y luego ejecutar un ReLoad:

sudo systemctl daemon-reload
sudo systemctl restart fluen-bit

Inicia FluentBit con tu archivo de configuraciÃ³n:

```bash
sudo /opt/fluent-bit/bin/fluent-bit -c /etc/fluent-bit/fluent-bit.conf
```

## âš™ï¸ Paso 6: VerificaciÃ³n en Elasticsearch

Confirma que FluentBit envÃ­a correctamente logs a Elasticsearch:

```bash
curl -X GET "localhost:9200/fluentbit-demo/_search?pretty"
```

DeberÃ­as ver los documentos JSON generados por tu aplicaciÃ³n demo.

---

## âš™ï¸ Paso 7: VisualizaciÃ³n en Kibana

Accede a Kibana desde tu navegador:

```
http://<ip-publica-vm>:5601
```

* DirÃ­gete a **Stack Management â†’ Index Patterns**.
* Crea un nuevo Ã­ndice llamado `fluentbit-demo`.
* Explora documentos indexados en **Discover**.

---

## âš™ï¸ Paso 8: CreaciÃ³n de Dashboard en Kibana

* Ve a **Analytics â†’ Dashboard â†’ Create New**.
* AÃ±ade visualizaciones:

  * **Bar Chart:** distribuciÃ³n por mensajes de log.
  * **Pie Chart:** proporciÃ³n de valores generados.
  * **Line Chart:** logs generados en el tiempo.

Guarda tu dashboard con nombre relevante (`Dashboard-FluentBit-Demo`).

---

## ğŸš® Limpieza (Opcional)

Para detener la generaciÃ³n automÃ¡tica de logs:

```bash
pkill -f "while true; do echo"
```

Para detener FluentBit:

```bash
sudo pkill fluent-bit
```

Elimina recursos Azure si no serÃ¡n utilizados nuevamente.

---

## ğŸ“Œ Recomendaciones finales

* Guarda capturas de pantalla y registros generados durante el laboratorio.
* Comparte preguntas o dudas con el instructor.

---

Â¡Excelente! ğŸš€ Ahora has configurado FluentBit y Kibana para anÃ¡lisis y visualizaciÃ³n avanzada de logs generados en tiempo real.
