üõ†Ô∏è Laboratorio Pr√°ctico: Instalaci√≥n y configuraci√≥n b√°sica de Elasticsearch en Azure VM
Duraci√≥n aproximada: 2 horas
Objetivo: Que los participantes puedan instalar y configurar Elasticsearch en una m√°quina virtual en Azure desde cero.

üìù Requisitos previos:
Cuenta activa de Azure con $50 USD asignados por estudiante.

Acceso a Azure Portal.

Conocimientos b√°sicos del uso de terminal o consola.

üö© Parte 1: Creaci√≥n de recursos en Azure (30 minutos)
‚úÖ Paso 1: Crear un grupo de recursos
Inicia sesi√≥n en Azure Portal.

Click en Resource Groups ‚Üí Create.

Escribe:

Nombre: elasticsearch-lab-rg

Regi√≥n: selecciona la m√°s cercana (p.ej., East US)

Click en Review + create, luego Create.

‚úÖ Paso 2: Crear una Virtual Network (VNet)
Ve al grupo de recursos creado (elasticsearch-lab-rg).

Click en + Add y busca "Virtual Network".

Nombre: elasticsearch-vnet

Address space: 10.0.0.0/16

Subnet:

Name: default

Address range: 10.0.0.0/24

Click en Review + create, luego Create.

‚úÖ Paso 3: Crear M√°quina Virtual (Azure VM)
Desde tu grupo de recursos, click en + Add y busca "Virtual Machine".

Configura as√≠:

Nombre VM: elasticsearch-vm

Regi√≥n: Misma regi√≥n que antes.

Imagen: Ubuntu Server 22.04 LTS.

Size: Elige uno econ√≥mico (ejemplo recomendado: B2s).

Authentication: SSH Public Key o usuario/contrase√±a (elige tu preferencia).

En Networking: aseg√∫rate que est√© asociada a la VNet creada (elasticsearch-vnet).

Revisa y haz click en Create.

‚ö†Ô∏è Importante: Guarda o descarga el archivo de claves SSH si lo usas.

üö© Parte 2: Instalaci√≥n b√°sica de Elasticsearch (45 minutos)
‚úÖ Paso 4: Conectarte a la Azure VM
Desde Azure Portal, accede a tu VM.

Copia la IP p√∫blica.

Usa SSH desde tu computadora para conectarte:

shell
Copy
Edit
ssh tu_usuario@ip_publica_vm
‚úÖ Paso 5: Instalar Java (Requisito previo de Elasticsearch)
shell
Copy
Edit
sudo apt update
sudo apt install openjdk-17-jdk -y
Verifica la instalaci√≥n:

shell
Copy
Edit
java -version
‚úÖ Paso 6: Instalar Elasticsearch
Descarga la clave GPG y a√±ade el repositorio Elasticsearch:

shell
Copy
Edit
wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg
echo "deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/8.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-8.x.list
Actualiza e instala Elasticsearch:

shell
Copy
Edit
sudo apt update
sudo apt install elasticsearch -y
‚úÖ Paso 7: Configurar Elasticsearch
Edita la configuraci√≥n:

shell
Copy
Edit
sudo nano /etc/elasticsearch/elasticsearch.yml
Dentro del archivo, a√±ade o modifica:

yaml
Copy
Edit
network.host: 0.0.0.0
http.port: 9200
discovery.type: single-node
xpack.security.enabled: false
Guarda y cierra (Ctrl + X, Y, luego Enter).

‚úÖ Paso 8: Iniciar y verificar Elasticsearch
Habilita e inicia el servicio:

shell
Copy
Edit
sudo systemctl enable elasticsearch
sudo systemctl start elasticsearch
Verifica el estado:

shell
Copy
Edit
sudo systemctl status elasticsearch
Prueba el acceso mediante CURL:

shell
Copy
Edit
curl -X GET "localhost:9200"
Deber√≠as recibir informaci√≥n JSON sobre el cluster Elasticsearch.

üö© Parte 3: Acceso remoto desde tu navegador local (20 minutos)
Desde Azure Portal:

Ve a tu VM ‚Üí Networking ‚Üí A√±ade una regla entrante para puerto 9200.

Luego, desde tu navegador, ingresa:

cpp
Copy
Edit
http://<ip_publica_vm>:9200
Deber√≠as ver una respuesta JSON con informaci√≥n del cluster Elasticsearch.

üö© Parte 4: Pruebas b√°sicas CRUD en Elasticsearch (25 minutos)
Desde la terminal conectada a tu VM:

‚úÖ Crear un √≠ndice:
shell
Copy
Edit
curl -X PUT "localhost:9200/mi_indice"
‚úÖ Insertar documento (Create):
shell
Copy
Edit
curl -X POST "localhost:9200/mi_indice/_doc/" -H 'Content-Type: application/json' -d'
{
  "curso": "Elasticsearch",
  "empresa": "Kyndryl",
  "duracion": "2 horas"
}'
‚úÖ Consultar documento (Read/Search):
shell
Copy
Edit
curl -X GET "localhost:9200/mi_indice/_search?pretty"
‚úÖ Actualizar documento (Update):
Cambia <document_id> por el ID obtenido al crear el documento:

shell
Copy
Edit
curl -X POST "localhost:9200/mi_indice/_update/<document_id>" -H 'Content-Type: application/json' -d'
{
  "doc": {"duracion": "4 horas"}
}'
‚úÖ Eliminar documento (Delete):
Cambia <document_id> por tu ID:

shell
Copy
Edit
curl -X DELETE "localhost:9200/mi_indice/_doc/<document_id>"
üö© Parte 5: Cierre y limpieza (5 minutos)
Det√©n Elasticsearch (opcional):

shell
Copy
Edit
sudo systemctl stop elasticsearch
Opcional: Elimina los recursos de Azure (si no los usar√°s m√°s):

Desde Azure Portal, ve al grupo de recursos y haz clic en Delete resource group.
