ğŸ› ï¸ Laboratorio: ConfiguraciÃ³n y anÃ¡lisis prÃ¡ctico de mÃ©tricas de infraestructura en Azure Monitor y Log Analytics
ğŸ“‹ Objetivo
Configurar un entorno de monitoreo centralizado en Azure usando Azure Monitor y Log Analytics, asociar una VM para recolectar mÃ©tricas y logs, crear alertas y construir dashboards personalizados para la infraestructura.

ğŸ“ Prerrequisitos
Acceso al Azure Portal

Permiso para crear y asociar recursos (VM, Log Analytics Workspace, alertas)

Al menos una mÃ¡quina virtual en Azure (Ubuntu o Windows)

SubscripciÃ³n activa (puede ser trial o credits acadÃ©micos)

âš™ï¸ Paso 1: Crear Log Analytics Workspace
Entra al Azure Portal.

Busca Log Analytics Workspaces > Create.

Completa:

Resource Group: Usa el asignado a tu usuario (ej. USER01-RG)

Name: user01-laworkspace (cambia segÃºn tu usuario)

Region: Selecciona la mÃ¡s cercana

Click en Review + create y luego Create.

âš™ï¸ Paso 2: Asociar una VM al Log Analytics Workspace
Ve a tu mÃ¡quina virtual en el portal.

En el menÃº izquierdo, selecciona Monitoring > Insights.

Haz clic en Enable para conectar la VM a Azure Monitor y Log Analytics.

Selecciona el workspace creado (user01-laworkspace).

Confirma y espera unos minutos a que los datos empiecen a fluir.

âš™ï¸ Paso 3: Configurar diagnÃ³stico y recopilaciÃ³n de mÃ©tricas avanzadas
En la VM, navega a Diagnostic settings (en Monitoring).

Haz clic en + Add diagnostic setting.

Selecciona:

Enviar a Log Analytics workspace: elige el workspace reciÃ©n creado.

Habilita Performance counters, Logs y Metrics.

Guarda los cambios.

âš™ï¸ Paso 4: Analizar mÃ©tricas en tiempo real
A) Con Metrics Explorer
Entra a Azure Monitor > Metrics.

Elige el recurso (VM) y mÃ©trica a analizar (ej. CPU Percentage, Disk Read Bytes/sec).

Agrega filtros (por tiempo, instancia, etc.).

Visualiza grÃ¡ficos y exporta si es necesario.

B) Con Log Analytics (Kusto Query Language - KQL)
Ve a Log Analytics Workspaces > selecciona tu workspace > Logs.

Ejemplo de consulta para eventos:

kql
Copy
Edit
Event
| where TimeGenerated > ago(1h)
| summarize count() by Level
Consulta de mÃ©tricas de rendimiento:

kql
Copy
Edit
Perf
| where ObjectName == "Processor"
| summarize avg(CounterValue) by bin(TimeGenerated, 5m), Computer
| render timechart
Consulta para ver logs de eventos crÃ­ticos:

kql
Copy
Edit
Event
| where Level == "Error"
| project TimeGenerated, Computer, EventID, RenderedDescription
âš™ï¸ Paso 5: Crear una alerta basada en mÃ©tricas
Ve a Azure Monitor > Alerts > + New alert rule.

Selecciona la VM como recurso.

Elige condiciÃ³n, por ejemplo:

Signal: CPU Percentage

Condition: Greater than 80%

Aggregation: Average, over 5 minutes

Crea un Action Group para enviar notificaciones (puedes usar tu correo electrÃ³nico).

Nombra y crea la alerta.

Prueba generando carga en la VM para disparar la alerta.

âš™ï¸ Paso 6: Construir un dashboard personalizado
En el portal, selecciona Dashboard > New dashboard.

Agrega tiles de mÃ©tricas (CPU, RAM, Disco, Red) usando â€œMetrics chartâ€.

Agrega un tile de logs con consultas KQL relevantes.

Personaliza colores, tamaÃ±o y disposiciÃ³n de widgets.

Guarda y comparte el dashboard si es necesario.

ğŸš® Limpieza (opcional)
Si terminaste, puedes deshabilitar la VM o eliminar los recursos creados para evitar costos.

ğŸ“Œ Notas y buenas prÃ¡cticas
Usa workspaces compartidos solo para entornos de prueba; en producciÃ³n, segmenta por funciÃ³n/regiÃ³n.

Revisa alertas periÃ³dicamente para evitar exceso de ruido (falsos positivos).

Aprovecha Workbooks para anÃ¡lisis mÃ¡s avanzados y presentaciones interactivas.

Â¡Laboratorio listo! ğŸš€ Ahora tienes visibilidad avanzada de tu infraestructura Azure con Azure Monitor y Log Analytics, y puedes extenderlo a aplicaciones, bases de datos y contenedores.
