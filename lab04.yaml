
# üõ†Ô∏è Laboratorio: Despliegue y configuraci√≥n de Dynatrace OneAgent en Azure

## üìã Objetivo

Instalar y configurar Dynatrace OneAgent en una m√°quina virtual en Azure, validar la conexi√≥n con la plataforma Dynatrace y explorar la visualizaci√≥n inicial de datos recolectados.

---

## üìù Requisitos previos

* Cuenta de Dynatrace (puedes usar el trial gratuito: [https://www.dynatrace.com/trial/](https://www.dynatrace.com/trial/))
* Acceso al [Azure Portal](https://portal.azure.com)
* Acceso SSH o RDP a una VM de Azure (Ubuntu o Windows Server)
* Navegador web

---

## ‚öôÔ∏è Paso 1: Crear una M√°quina Virtual en Azure

1. Inicia sesi√≥n en el [Azure Portal](https://portal.azure.com).
2. Ve a **Resource Groups** y usa el grupo asignado a tu usuario (`USER01-RG`, `USER02-RG`, etc.).
3. Haz clic en **+ Add** > **Virtual Machine**.
4. Elige:

   * Imagen: **Ubuntu 22.04 LTS** (o Windows Server si prefieres).
   * Tama√±o: `Standard_B2s` o similar.
   * Usuario y autenticaci√≥n (clave SSH o contrase√±a segura).
   * Red: Asocia la VM a tu VNet asignada.
5. Haz clic en **Review + Create** y luego en **Create**.
6. Una vez desplegada, anota la **IP p√∫blica** de la VM.

---

## ‚öôÔ∏è Paso 2: Acceder a Dynatrace y obtener el instalador de OneAgent

1. Ingresa a tu cuenta Dynatrace (https\://{your-environment-id}.live.dynatrace.com o usa la trial).
2. En el men√∫ izquierdo, ve a **Deploy Dynatrace** > **Start installation**.
3. Elige el sistema operativo de tu VM (Linux/Windows).
4. Copia el comando de instalaci√≥n personalizado que incluye tu **token de entorno**.

---

## ‚öôÔ∏è Paso 3: Instalar Dynatrace OneAgent en la Azure VM

### Para **Ubuntu Linux**:

1. Con√©ctate por SSH a tu VM:

   ```bash
   ssh usuario@<ip-publica-vm>
   ```

2. **Ejecuta el comando de instalaci√≥n** (ejemplo, reemplaza por el que copiaste en Dynatrace):

   ```bash
   wget -O Dynatrace-OneAgent.sh "<ENLACE_DESCARGA_DEL_PORTAL_DYNATRACE>"
   sudo /bin/sh Dynatrace-OneAgent.sh
   ```

   *Nota: El comando oficial de Dynatrace ya hace todo en uno, as√≠ que simplemente p√©galo y ejecuta.*

3. Espera a que termine la instalaci√≥n.
   Verifica que el servicio est√© corriendo:

   ```bash
   sudo systemctl status oneagent
   ```

### Para **Windows Server**:

1. Con√©ctate por RDP.
2. Descarga el instalador desde el portal Dynatrace.
3. Ejecuta el instalador como Administrador y sigue el asistente.
4. Finaliza la instalaci√≥n.

---

## ‚öôÔ∏è Paso 4: Validar la conexi√≥n de la VM con Dynatrace

1. Vuelve al portal Dynatrace, ve a **Hosts**.
2. Deber√≠as ver tu VM Azure conectada como un host monitorizado.
3. Haz clic sobre el host para ver detalles: procesos, servicios, m√©tricas de hardware.

---

## ‚öôÔ∏è Paso 5: Generar actividad para visualizar datos

* Ejecuta algunos comandos o procesos en la VM para generar m√©tricas.
* (Opcional) Instala un servidor web simple para ver detecci√≥n autom√°tica de servicios:

  ```bash
  sudo apt update
  sudo apt install apache2 -y
  sudo systemctl start apache2
  ```

---

## ‚öôÔ∏è Paso 6: Explorar visualizaciones iniciales en Dynatrace

1. En el host registrado, explora:

   * Consumo de CPU, memoria, disco y red.
   * Procesos detectados autom√°ticamente.
   * Servicios y puertos abiertos.
2. Ve a **Smartscape** para visualizar la topolog√≠a.
3. Prueba el **Data Explorer** para crear un gr√°fico simple de m√©tricas.

---

## ‚öôÔ∏è Paso 7: (Opcional) Habilitar Real User Monitoring (RUM) o Synthetic Monitoring

* En Dynatrace, explora la opci√≥n **Applications & Microservices**.
* Si tienes una web en la VM, sigue las instrucciones para integrar el snippet de RUM.

---

## üöÆ Limpieza (Opcional)

* Cuando termines el laboratorio, puedes detener la VM para ahorrar cr√©dito o eliminar el resource group en Azure si ya no lo usas.

---

## üìå Recomendaciones

* Toma capturas de pantalla como evidencia de la VM apareciendo en Dynatrace y de los primeros dashboards.
* Si tienes problemas con la instalaci√≥n, revisa los logs de OneAgent:

  ```bash
  sudo less /var/log/dynatrace/oneagent/oneagent.log
  ```

---

¬°Laboratorio completo! üöÄ Ahora tienes visibilidad de tu VM Azure en Dynatrace y puedes continuar con la exploraci√≥n y an√°lisis avanzado.
