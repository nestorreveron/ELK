
# ğŸ§‘â€ğŸ’» Laboratorio Opcional Avanzado:

**AnÃ¡lisis avanzado y visualizaciones interactivas en Kibana**

---

## ğŸ“‹ Objetivo

Profundizar en el uso de Kibana para anÃ¡lisis avanzados:

* Crear visualizaciones avanzadas (TSVB, Heatmaps, Gauges, Maps, etc.)
* Dominar el uso de dashboards dinÃ¡micos e interactivos
* Realizar bÃºsquedas complejas con KQL y transformar la experiencia de anÃ¡lisis
* Configurar alertas y automatizaciones en la plataforma
* Documentar, compartir y exportar hallazgos de forma profesional

---

## ğŸ“ Requisitos previos

* Haber completado el Lab02 (tener Elasticsearch y Kibana funcionales con datos reales en el Ã­ndice `mi_indice`).
* Acceso al portal web de Kibana desde tu navegador.
* Disponer de documentos en el Ã­ndice con campos como: `empresa`, `status`, `bytes`, `curso`, `fecha`, etc.
* Rol de usuario con permisos para crear visualizaciones y dashboards.

---

## âš™ï¸ Paso 1: Explora y comprende tus datos

1. Entra a **Discover** en Kibana.
2. Selecciona el data view `mi_indice`.
3. **Analiza los campos disponibles** (panel izquierdo), observa los tipos de datos (texto, nÃºmero, fecha).
4. Haz bÃºsquedas simples:

   * Â¿CuÃ¡ntos documentos hay por empresa?
   * Â¿QuÃ© rangos de valores existen para `bytes` y `status`?
5. Ajusta el rango de tiempo en la parte superior derecha para incluir todos tus datos relevantes.
6. Si es posible, **exporta una muestra** a CSV para revisar la calidad de los datos.

---

## âš™ï¸ Paso 2: Crea visualizaciones avanzadas

### **A. Time Series Visual Builder (TSVB)**

1. Ve a **Analytics â†’ Visualize Library â†’ Create visualization**.
2. Selecciona **Time Series**.
3. Elige tu data view `mi_indice`.
4. **Configura tu panel:**

   * MÃ©trica: Usa `count` (conteo de documentos) o el promedio de `bytes` por intervalo de tiempo.
   * Filtros:

     * Solo documentos de una empresa (`empresa: "Kyndryl"`)
     * Solo status:200 vs status:500 para comparar.
   * AÃ±ade **moving average** (media mÃ³vil) para identificar tendencias.
   * Personaliza leyendas, tÃ­tulos y formato de fechas.
5. Guarda como â€œTendencia Bytes por Statusâ€.

---

### **B. Heatmap (Mapa de Calor)**

1. Crea una nueva visualizaciÃ³n **Heatmap**.
2. Eje X: Por ejemplo, hora del dÃ­a (`fecha` en modo hora)
   Eje Y: Status (`status`)
3. MÃ©trica: Conteo de documentos.
4. El heatmap mostrarÃ¡ **dÃ³nde hay mÃ¡s errores o actividad** segÃºn la hora y status.
5. Guarda como â€œHeatmap de Actividadâ€.

---

### **C. Gauge y Goal (Medidores y Metas)**

1. Selecciona **Gauge**.
2. MÃ©trica: Porcentaje de logs exitosos (`status: "200"`) respecto al total.
3. Configura los umbrales de colores (verde, amarillo, rojo).
4. Opcional: Agrega una meta para cantidad mÃ­nima de operaciones exitosas diarias.
5. Guarda como â€œMedidor de Ã‰xitoâ€.

---

### **D. Maps (GeolocalizaciÃ³n, si hay datos geogrÃ¡ficos)**

1. Ve a **Maps â†’ Create map**.
2. Usa un campo tipo paÃ­s o ciudad, o mejor aÃºn un `geo_point` si existe.
3. Crea un mapa de densidad de eventos por paÃ­s o regiÃ³n.
4. Agrega capas adicionales:

   * Un layer para status:500 (errores),
   * Otro para status:200 (Ã©xitos).
5. Guarda como â€œMapa GeogrÃ¡fico de Operacionesâ€.

---

### **E. Bar, Pie y Line Charts (para complementar)**

1. Crea **Bar Chart**:

   * Top empresas por cantidad de cursos.
2. Crea **Pie Chart**:

   * ProporciÃ³n de status (200, 404, 500).
3. Crea **Line Chart**:

   * EvoluciÃ³n de bytes transferidos por fecha.

---

## âš™ï¸ Paso 3: Construye y personaliza tu dashboard interactivo

1. Ve a **Analytics â†’ Dashboard â†’ Create new dashboard**.
2. AÃ±ade tus visualizaciones avanzadas y bÃ¡sicas desde la **library**.
3. Organiza el dashboard:

   * Coloca los indicadores clave en la parte superior (gauges, metas, KPIs).
   * Pon visualizaciones de tendencia y heatmaps en el centro.
   * Usa mapas y grÃ¡ficos circulares/barra al pie para anÃ¡lisis comparativos.
4. Renombra el dashboard como **â€œDashboard Avanzado Observabilidadâ€**.
5. Ajusta el rango de fechas global y prueba los filtros.

---

### **Hazlo interactivo:**

* Usa la barra de KQL para filtrar dinÃ¡micamente:

  * Solo una empresa (`empresa: "Kyndryl"`)
  * Solo eventos grandes (`bytes > 1000`)
  * Solo errores (`status: "500"`)
* Prueba â€œdrilldownsâ€: Haz clic en un segmento de un grÃ¡fico y ve cÃ³mo se filtran los demÃ¡s paneles (si tu versiÃ³n de Kibana lo permite).
* Modifica colores, tÃ­tulos y leyendas para hacerlo mÃ¡s intuitivo.

---

## âš™ï¸ Paso 4: BÃºsquedas y anÃ¡lisis avanzados con KQL

1. Realiza bÃºsquedas complejas:

   * Solo eventos de cierta empresa y bytes altos:

     ```kql
     empresa: "Kyndryl" AND bytes > 1500
     ```
   * Errores en un rango de fechas:

     ```kql
     status: "500" AND fecha >= "2024-05-01" AND fecha <= "2024-05-31"
     ```
   * Existencia de un campo:

     ```kql
     _exists_: user_agent
     ```
   * Consultas combinadas y anidadas:

     ```kql
     (status: "200" AND bytes > 500) OR (status: "500" AND empresa: "Microsoft")
     ```
2. Observa cÃ³mo el dashboard reacciona instantÃ¡neamente a los filtros avanzados.

---

## âš™ï¸ Paso 5: AutomatizaciÃ³n y alertas (si tu Kibana lo soporta)

1. Ve a **Stack Management â†’ Alerts and Actions**.
2. Crea una alerta:

   * CondiciÃ³n: porcentaje de errores (`status:500`) supera 5% del total en 10 minutos.
   * AcciÃ³n: Enviar email, webhook, log en disco, etc.
3. Haz pruebas:

   * Genera manualmente algunos documentos de error para verificar que la alerta se dispare.
4. Integra la visualizaciÃ³n de alertas en el dashboard (algunos paneles pueden mostrar el estado de alertas activas).

---

## âš™ï¸ Paso 6: Exporta, documenta y comparte

1. Usa la opciÃ³n **Share** para exportar el dashboard como PDF, PNG, o genera un enlace temporal para compartirlo.
2. Escribe una breve documentaciÃ³n:

   * **Â¿QuÃ© mide cada panel?**
   * **Â¿QuÃ© patrones o anomalÃ­as encontraste?**
   * **Â¿QuÃ© decisiones puedes tomar con esta informaciÃ³n?**
3. Si el dashboard es para un equipo, deja notas y recomendaciones para que puedan reutilizarlo o expandirlo.

---

## ğŸš€ **DesafÃ­o profesional extra**

* **Crea un dashboard de troubleshooting integral:**
  Incluye paneles de logs, mÃ©tricas, errores, y recursos (CPU, memoria si tienes esos datos).
* **Agrega paneles de comparaciÃ³n entre empresas o periodos de tiempo.**
* **Integra visualizaciones de Machine Learning** (si Kibana/Elastic lo permite) para detecciÃ³n automÃ¡tica de anomalÃ­as.

---

## ğŸš® **Limpieza final (opcional)**

* Borra dashboards, visualizaciones o alertas de prueba si ya no las necesitas.
* Revisa las configuraciones de seguridad: restringe el acceso externo al puerto 5601 si ya no lo usas.
* Documenta cualquier configuraciÃ³n especial que hayas realizado para poder replicar el laboratorio.

---

## ğŸ“Œ **Tips expertos**

* Usa la opciÃ³n **Inspect** en cada visualizaciÃ³n para ver la query que ejecuta.
* Si tienes Elastic Stack Premium, explora los mÃ³dulos de Machine Learning.
* **Versiona** tus dashboards exportando el JSON de configuraciÃ³n.
* Agrega descripciones y tÃ­tulos claros a cada panel para que el dashboard sea autoexplicativo.


