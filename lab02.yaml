# ğŸ› ï¸ Laboratorio: CreaciÃ³n y exploraciÃ³n de dashboards con datos reales en Kibana

## ğŸ“‹ Objetivo

Crear dashboards interactivos en Kibana con datos reales almacenados previamente en Elasticsearch, utilizando una VM en Azure creada previamente.

---

## ğŸ“ Requisitos previos

* Haber completado el [Laboratorio DÃ­a 1](#) (Elasticsearch en Azure).
* VM con Elasticsearch instalado (Ubuntu 22.04).
* Acceso SSH y al Azure Portal.

---

## âš™ï¸ Paso 1: InstalaciÃ³n de Kibana en Azure VM

**ConÃ©ctate vÃ­a SSH a tu VM Azure:**

```bash
ssh usuario@<ip-publica-vm>
```

**Actualiza repositorios e instala Kibana:**

```bash
sudo apt update
sudo apt install kibana -y
```

---

## âš™ï¸ Paso 2: ConfiguraciÃ³n bÃ¡sica de Kibana

Edita el archivo de configuraciÃ³n Kibana:

```bash
sudo nano /etc/kibana/kibana.yml
```

Agrega o modifica la siguiente lÃ­nea para conectar Kibana con Elasticsearch:

```yaml
elasticsearch.hosts: ["http://localhost:9200"]
server.host: "0.0.0.0"
```

Guarda el archivo (`Ctrl+X`, `Y`, `Enter`).

**Inicia y habilita Kibana:**

```bash
sudo systemctl enable kibana
sudo systemctl start kibana
sudo systemctl status kibana
```

---

## âš™ï¸ Paso 3: Permitir acceso externo a Kibana desde Azure

* En Azure Portal, accede a tu VM â†’ Networking.
* Agrega una regla entrante para permitir acceso al puerto TCP `5601`.

**Verifica en navegador:**

```
http://<ip-publica-vm>:5601
```

---

## âš™ï¸ Paso 4: Crear Ã­ndice en Kibana

* Accede a Kibana desde tu navegador.
* Ve a **Stack Management â†’ Data â†’ Index Patterns**.
* Click en **Create Index Pattern**.
* Escribe el nombre del Ã­ndice creado el dÃ­a anterior (ej. `mi_indice`) y haz clic en **Next Step**.
* Selecciona el campo de tiempo si aplica, o **skip** si no lo tienes.
* Finaliza con **Create Index Pattern**.


Agregar informaciÃ³n:

1. Verifica si tu Ã­ndice tiene datos en Elasticsearch
En tu servidor o desde una terminal con acceso a Elasticsearch:

curl -X GET "localhost:9200/mi_indice/_search?pretty"

O (para solo contar documentos):

curl -X GET "localhost:9200/mi_indice/_count?pretty"

Si el resultado es {"count":0...}, tu Ã­ndice estÃ¡ vacÃ­o.

Si hay datos pero no los ves en Kibana, revisa el rango de fechas (ver punto 3).

2. Ingresa datos de ejemplo al Ã­ndice (si estÃ¡ vacÃ­o)
Puedes insertar documentos manualmente para pruebas rÃ¡pidas:

curl -X POST "localhost:9200/mi_indice/_doc" -H 'Content-Type: application/json' -d'
{
  "curso": "ELK BÃ¡sico",
  "empresa": "Kyndryl",
  "duracion": 6,
  "fecha": "2024-05-19T10:00:00Z",
  "status": "200"
}'

Repite con mÃ¡s ejemplos cambiando los valores.

Vuelve a consultar con /_count y asegÃºrate que tienes varios documentos.

3. Ajusta el rango de fechas en Kibana

MUY IMPORTANTE:
Kibana, por defecto, solo muestra datos recientes (Ãºltimos 15 minutos/Ãºltima hora).

En la parte superior derecha, cambia el rango de tiempo a un rango mayor (por ejemplo: Last 7 days, This year, o un rango absoluto que cubra las 
fechas de tus documentos de prueba).

Si tus documentos no tienen campo de tiempo compatible (@timestamp), crea el Ã­ndice sin campo temporal o selecciona â€œI donâ€™t want to use the time filterâ€.

4. Actualiza y vuelve a crear las visualizaciones
Cuando confirmes que tienes datos:

Ve a Discover y verifica que aparecen documentos.

Ahora, en Dashboards, selecciona los campos deseados en la visualizaciÃ³n.

Si solo ves campos â€œEmpty fieldsâ€, es porque no hay datos indexados o el mapping estÃ¡ mal.

5. (Opcional) Reindexa o ingresa nuevos datos si cambiaste el mapping

Si cambiaste el mapping o el formato del Ã­ndice, puede que debas reindexar o borrar/recrear el Ã­ndice.

Resumen de pasos rÃ¡pidos:

Verifica si tienes datos en el Ã­ndice:

curl -X GET "localhost:9200/mi_indice/_count?pretty"

Inserta documentos de prueba si estÃ¡ vacÃ­o.

AsegÃºrate de que el rango de fechas en Kibana cubra los documentos.

Confirma que ves datos en Discover antes de crear dashboards.

Vuelve a construir visualizaciones con los nuevos campos que aparecen.

---

## âš™ï¸ Paso 5: Crear visualizaciones bÃ¡sicas

Ve a **Analytics â†’ Dashboard â†’ Create new**.

* Click **Create Visualization**.
* Selecciona **Bar Chart**:

  * Configura en eje X el campo deseado (ej.: `status`) y Y para contar documentos.
* AÃ±ade visualizaciÃ³n.

Repite con otras visualizaciones:

* **Pie Chart**: proporciÃ³n de documentos por campo (ej. `empresa`).
* **Line Chart**: tendencias en cantidad de documentos en el tiempo.
* Guarda cada visualizaciÃ³n individualmente.

---

## âš™ï¸ Paso 6: CreaciÃ³n de un Dashboard

* En **Dashboard**, haz click en **Add from library**.
* Selecciona visualizaciones creadas anteriormente.
* Organiza visualizaciones en el dashboard usando drag & drop.
* Guarda dashboard con nombre relevante (ej. `Dashboard_Curso`).

---

## âš™ï¸ Paso 7: Uso bÃ¡sico de Kibana Query Language (KQL)

Desde tu dashboard:

* Usa la barra superior para filtrar usando consultas bÃ¡sicas KQL:

Ejemplos:

* Filtrar por un valor especÃ­fico:

```kql
empresa: "Kyndryl"
```

* Rango numÃ©rico:

```kql
bytes > 1000
```

* Combinar condiciones:

```kql
status: "200" AND bytes > 500
```

Observa cÃ³mo cambian las visualizaciones dinÃ¡micamente.

---

## âš™ï¸ Paso 8: Compartir y exportar Dashboards

* Guarda los dashboards creados.
* Explora opciones para compartir dashboard (exportar PDF, generar enlaces).

---

## ğŸš® Limpieza (Opcional)

Si ya no usarÃ¡s estos recursos, elimina desde Azure Portal:

* Ve a tu grupo de recursos y elimina recursos para evitar costos innecesarios.

---

## ğŸ“Œ Recomendaciones finales

* Documenta y guarda evidencia de visualizaciones creadas.
* Comparte cualquier duda o consulta durante la sesiÃ³n.

---

Â¡Excelente trabajo! ğŸš€ Ahora has creado dashboards interactivos en Kibana conectados a Elasticsearch, fortaleciendo tus habilidades en anÃ¡lisis y visualizaciÃ³n de datos.
